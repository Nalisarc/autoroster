DSMITH12862#+title: Auto Roster Report Maker
#+Author: Daniel Alexander Smith
#+email: u0346076@utah.edu
#+TAGS: readme(r) noexport(n)
#+STARTUP: content

* TODO Readme                                                        :readme:
Autoroster is a program used to generate daily and weekly roster reports.


* TODO Licence                                                      :licence:
Right now this program does not have a license. I'll most likely give it either a GPL or an LGPL.
However that isn't a priority at the moment. Assume that you are not allowed to use it, unless I've told you it's okay.

* Requirements For Development
Autoroster uses pyqt5 for the gui.
I'm not sure if xlrd is still nessisary, if it's not I'm going to remove it.
#+name: requirements
#+BEGIN_SRC text :tangle requirements.txt
  pyqt5
  pandas
  numpy
  xlrd
  openpyxl
#+END_SRC




** Data input and Processing

*** Read in workbook
#+name: open_roster
#+BEGIN_SRC python
import openpyxl
import pandas


def open_roster(path, skip=2):
    wb = openpyxl.load_workbook(path)
    ws = wb.active
    data = ws.values

    for s in range(skip):
        next(data)

    cols = next(data)[1:]
    data = list(data)
    idx = [r[0] for r in data]
    data = (islice(r, 1, None) for r in data)
    df = pandas.DataFrame(data,index=idx,columns=cols)

    return df
#+END_SRC
*** Tests
#+name: datainp-tests
#+BEGIN_SRC python :tangle tests/test_datainp.py
import autoroster.core

def test_can_open_roster():
    testr = autoroster.core.open_roster("./testrosters/testrosterblank.xlsx")

def test_roster_is_data_frame():
    testr = autoroster.core.open_roster("./testrosters/testrosterblank.xlsx")
    assert str(type(testr)) == "<class 'pandas.core.frame.DataFrame'>"

def test_roster_contains_proper_header():
    testr = autoroster.core.open_roster("./testrosters/testrosterblank.xlsx")
    assert "Student Name" in list(testr)

#+END_SRC

** Output

** UI

** Main

#+BEGIN_SRC python :tangle autoroster/core.py :noweb yes
<<open_roster>>
#+END_SRC

** Misc
To get elpy to work properly, the following packages.
#+name: elpy-packs
#+BEGIN_EXAMPLE
  jedi
  yapf
  Autopep8
  flake8
#+END_EXAMPLE
